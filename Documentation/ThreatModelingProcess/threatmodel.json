{
  "summary": {
    "title": "TruckMotion Threat Model",
    "owner": "DESOFS 3",
    "description": "Model for TruckMotion",
    "id": 0
  },
  "detail": {
    "contributors": [
      {
        "name": "Nuno Marmeleiro"
      },
      {
        "name": "Rogério Sousa"
      },
      {
        "name": "Óscar Folha"
      },
      {
        "name": "Rafael Oliveira"
      },
      {
        "name": "Rafael Faísca"
      }
    ],
    "diagrams": [
      {
        "cells": [
          {
            "position": {
              "x": 650,
              "y": 370
            },
            "size": {
              "width": 160,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "Database"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 2,
            "id": "936557f9-22e2-4bac-bb70-0089c5c2fbe1",
            "data": {
              "name": "Database",
              "description": "",
              "type": "tm.Store",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [
                {
                  "status": "Mitigated",
                  "severity": "High",
                  "description": "An attacker could make an query call on the DB.",
                  "title": "Unauthorised access",
                  "type": "Information disclosure",
                  "mitigation": "Require all queries to be authenticated.",
                  "modelType": "STRIDE",
                  "id": "21fc4b20-ca29-4891-9691-d8f0331b2a11",
                  "new": false
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "description": "An attacker could obtain the DB credentials and use them to make unauthorised queries.",
                  "title": "Credential theft",
                  "type": "Information disclosure",
                  "mitigation": "Use a firewall to restrict access to the DB to only the Backend IP address.",
                  "modelType": "STRIDE",
                  "id": "e12765bf-ec61-47d8-8e9f-6bb3f5adab47",
                  "new": false
                }
              ],
              "hasOpenThreats": true,
              "isALog": true,
              "storesCredentials": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesInventory": null
            }
          },
          {
            "position": {
              "x": 150,
              "y": 500
            },
            "size": {
              "width": 160,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "Backend Application Config"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": "4 3"
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": "4 3"
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 3,
            "id": "bdd3e115-4b92-4020-90b7-c3351dba292b",
            "data": {
              "name": "Backend Application Config",
              "description": "",
              "type": "tm.Store",
              "isTrustBoundary": false,
              "outOfScope": true,
              "reasonOutOfScope": "",
              "threats": [
                {
                  "status": "Open",
                  "severity": "High",
                  "title": "Credentials should be encrypted",
                  "type": "Information disclosure",
                  "description": "The Web Application Config stores credentials used  by the Web App to access the message queue. These could be stolen by an attacker and used to read confidential data or place poison message on the queue.",
                  "mitigation": "The Message Queue credentials should be encrypted.",
                  "modelType": "STRIDE",
                  "id": "aaea0238-2984-4b25-8268-3798e63bed34"
                }
              ],
              "hasOpenThreats": true,
              "isALog": false,
              "storesCredentials": true,
              "isEncrypted": true,
              "isSigned": false,
              "storesInventory": null
            }
          },
          {
            "position": {
              "x": 380,
              "y": 270
            },
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Backend\nApplication"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 6,
            "id": "0d9909ea-1398-4898-be81-cf1c808324dc",
            "data": {
              "name": "Backend\nApplication",
              "description": "Process that contains all the interactions needed to the backend API application",
              "type": "tm.Process",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [
                {
                  "id": "9b63b86c-9242-42a1-a255-cd9aa39b8d7b",
                  "title": "Attacker sends too many requests",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "An attacker send too many requests to API endpoint so that the service goes down.",
                  "mitigation": "Add a strategy that blocks requests when the amount is high and the interval of time is low.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 32,
                  "score": ""
                },
                {
                  "id": "b1803af5-f94f-47d7-916e-bf34d15ee7a9",
                  "title": "Attacker sends API Request via Tool to steal data",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Attacker sends a request using another tool (i.e.: postman) with the known endpoint to gather data.",
                  "mitigation": "Add tokens or some type of authentication inside backend.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 33,
                  "score": ""
                },
                {
                  "id": "c9f36766-fde7-4b26-a23b-268af3e1ea3f",
                  "title": "Attacker sends an API POST/Delete Request",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Attacker uses another tool instead of browser (i.e.: postman) to update or delete data inside the application.",
                  "mitigation": "Add token/authentication inside the backend.\nDo not allow delete endpoints.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 35,
                  "score": ""
                },
                {
                  "id": "cf2a17f9-5cfa-478a-a69e-3b85e61cc90e",
                  "title": "Attacker steals Authentication Token",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "Attacker successfully steals or even generates a valid authentication token, with this, gaining access to data through API endpoints.",
                  "mitigation": "Implement techniques to not use one static token, such as the refresh token.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 36,
                  "score": ""
                },
                {
                  "id": "e79ce516-93fa-4912-8691-4c9b8c2e5ae3",
                  "title": "User pretends to be someone else changing Header Parameter",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "The user, by manipulating the API Request changing the Header Parameter username, pretends to be someone else in the logging system and the actions taken are associated wrongly, making the logging invalid.",
                  "mitigation": "Implement logging based on the token used to get the user in question and not the header user name parameter.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 37,
                  "score": ""
                },
                {
                  "id": "3cbef165-381b-4a7e-9cc6-c0151ecadaee",
                  "title": "User by using their token successfully performs actions outside their authorization",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Elevation of privilege",
                  "description": "A user, by sending an API Request to an End Point using their token, can successfully perform some action that is beyond their authorization.",
                  "mitigation": "Implement authorization based on token and more inside the backend API.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 39,
                  "score": ""
                }
              ],
              "hasOpenThreats": true,
              "isWebApplication": null,
              "handlesCardPayment": null,
              "handlesGoodsOrServices": null
            }
          },
          {
            "position": {
              "x": 22.5,
              "y": 30
            },
            "size": {
              "width": 160,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "Browser"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 7,
            "id": "b394f9f7-07ca-42bc-b616-ad77c6fbfcce",
            "data": {
              "name": "Browser",
              "description": "",
              "type": "tm.Actor",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [
                {
                  "id": "ac1a5a61-7f81-47f8-b88e-f1087b5d0f36",
                  "title": "GPS Spoofing",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "Users can use GPS Spoofing applications to fake the geographical location.",
                  "mitigation": "Apply mechanisms to detect suspicious changes of location that can be associate with GPS Spoofing, for example, if a driver changes from a location to another distancing more than 1km faster than a second, it triggers a warning.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 16,
                  "score": ""
                }
              ],
              "hasOpenThreats": true,
              "providesAuthentication": false
            }
          },
          {
            "shape": "trust-boundary-curve",
            "attrs": {
              "line": {
                "targetMarker": "",
                "sourceMarker": ""
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "0adc088b-ebb1-46be-af7b-36112c60c419",
            "labels": [
              {
                "attrs": {
                  "text": {
                    "text": ""
                  }
                }
              }
            ],
            "source": {
              "x": 80,
              "y": 220
            },
            "target": {
              "x": 295,
              "y": 51
            },
            "vertices": [
              {
                "x": 276,
                "y": 149
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1,
                "targetMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Queries",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [],
              "isTrustBoundary": false
            },
            "id": "8a9007e8-ae66-4568-84c7-9bcbc1e2fdab",
            "labels": [
              {
                "position": 0.5,
                "attrs": {
                  "label": {
                    "text": "Queries"
                  }
                }
              }
            ],
            "source": {
              "cell": "0d9909ea-1398-4898-be81-cf1c808324dc"
            },
            "target": {
              "cell": "936557f9-22e2-4bac-bb70-0089c5c2fbe1"
            },
            "vertices": [
              {
                "x": 600,
                "y": 400
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Upload Files",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "aabdcb4a-b81c-44ae-a58a-a0bd2826b450",
            "labels": [
              "Upload Files"
            ],
            "source": {
              "cell": "0d9909ea-1398-4898-be81-cf1c808324dc"
            },
            "target": {
              "cell": "95f959ad-c996-4258-b1ed-fce33dfa5b69"
            },
            "vertices": [
              {
                "x": 530,
                "y": 510
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Query\nResults",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [],
              "isTrustBoundary": false
            },
            "id": "d071f844-374b-4957-8664-4f53ec0807cc",
            "labels": [
              "Query\nResults"
            ],
            "source": {
              "cell": "936557f9-22e2-4bac-bb70-0089c5c2fbe1"
            },
            "target": {
              "cell": "0d9909ea-1398-4898-be81-cf1c808324dc"
            },
            "vertices": [
              {
                "x": 610,
                "y": 325
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1,
                "targetMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Web Request",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": true,
              "protocol": "HTTP/S",
              "threats": [
                {
                  "status": "Mitigated",
                  "severity": "High",
                  "title": "Data flow should use HTTP/S",
                  "type": "Information disclosure",
                  "description": "These requests are made over the public internet and could be intercepted by an attacker.",
                  "mitigation": "The requests should require HTTP/S. This will provide confidentiality and integrity. HTTP should not be supported.",
                  "modelType": "STRIDE",
                  "id": "79cbaf10-e5a2-4fd6-9818-7f180a113938"
                }
              ],
              "isTrustBoundary": false
            },
            "id": "2d84bfae-f1ed-49e5-8542-10a02f4a1c57",
            "labels": [
              {
                "position": 0.5,
                "attrs": {
                  "label": {
                    "text": "Web Request (HTTP/S)"
                  }
                }
              }
            ],
            "source": {
              "cell": "b394f9f7-07ca-42bc-b616-ad77c6fbfcce"
            },
            "target": {
              "cell": "22eddb4b-7085-4ae6-8837-c052c09d18cd"
            },
            "vertices": [
              {
                "x": 245,
                "y": 112
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1,
                "targetMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Web Response",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": true,
              "protocol": "HTTP/S",
              "threats": [
                {
                  "status": "Mitigated",
                  "severity": "High",
                  "title": "Data flow should use HTTP/S",
                  "type": "Information disclosure",
                  "description": "These responses are over the public internet and could be intercepted by an attacker.",
                  "mitigation": "The requests should require HTTP/S. This will provide confidentiality and integrity. HTTP should not be supported.",
                  "modelType": "STRIDE",
                  "id": "2cba4931-e49c-4d4c-ad7c-d2de4875f15a"
                }
              ],
              "isTrustBoundary": false
            },
            "id": "28d7c778-8fdf-43d6-9461-b25281743883",
            "labels": [
              {
                "position": 0.5,
                "attrs": {
                  "label": {
                    "text": "Web Response (HTTP/S)"
                  }
                }
              }
            ],
            "source": {
              "cell": "22eddb4b-7085-4ae6-8837-c052c09d18cd"
            },
            "target": {
              "cell": "b394f9f7-07ca-42bc-b616-ad77c6fbfcce"
            },
            "vertices": [
              {
                "x": 111,
                "y": 175
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": "4 3"
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Read Backend \nApplication Config",
              "description": "",
              "outOfScope": true,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "0142ccb7-8361-4fde-88ef-83a816baad9e",
            "labels": [
              "Read Backend \nApplication Config"
            ],
            "source": {
              "cell": "bdd3e115-4b92-4020-90b7-c3351dba292b"
            },
            "target": {
              "cell": "0d9909ea-1398-4898-be81-cf1c808324dc"
            },
            "vertices": [
              {
                "x": 220.1,
                "y": 440
              },
              {
                "x": 280,
                "y": 400
              },
              {
                "x": 320,
                "y": 380
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "REST Request",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "a5ab7d3b-a44f-4525-acf8-8ffdefe64d9b",
            "labels": [
              "REST Request"
            ],
            "source": {
              "cell": "22eddb4b-7085-4ae6-8837-c052c09d18cd"
            },
            "target": {
              "cell": "0d9909ea-1398-4898-be81-cf1c808324dc"
            },
            "vertices": [
              {
                "x": 220,
                "y": 325
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "REST Response",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "1e24df99-5f4f-4510-afa4-bd8e32515c65",
            "labels": [
              "REST Response"
            ],
            "source": {
              "cell": "0d9909ea-1398-4898-be81-cf1c808324dc"
            },
            "target": {
              "cell": "22eddb4b-7085-4ae6-8837-c052c09d18cd"
            },
            "vertices": [
              {
                "x": 410,
                "y": 180
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": "4 3"
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Read Frontend \nApplication Config",
              "description": "",
              "outOfScope": true,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "d9a3d8b8-6945-42f8-8c90-a655bb960a06",
            "labels": [
              "Read Frontend \nApplication Config"
            ],
            "source": {
              "cell": "6ec437d3-79c1-4d2c-a620-530caeab8134"
            },
            "target": {
              "cell": "22eddb4b-7085-4ae6-8837-c052c09d18cd"
            }
          },
          {
            "shape": "trust-boundary-curve",
            "attrs": {
              "line": {
                "targetMarker": "",
                "sourceMarker": ""
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "4a7911c8-2493-46cc-960f-1b248b176d15",
            "labels": [
              {
                "attrs": {
                  "text": {
                    "text": ""
                  }
                }
              }
            ],
            "source": {
              "x": 690,
              "y": 510
            },
            "target": {
              "x": 860,
              "y": 410
            },
            "vertices": [
              {
                "x": 630,
                "y": 460
              },
              {
                "x": 630,
                "y": 380
              },
              {
                "x": 770,
                "y": 330
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "1d336bbe-b247-41ec-9cc6-0d8133b9419b",
            "source": {
              "x": -110,
              "y": 350
            },
            "target": {
              "x": 50,
              "y": 470
            },
            "vertices": [
              {
                "x": -10,
                "y": 320
              },
              {
                "x": 60,
                "y": 350
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Display/Download \nfiles",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "b5d8cf88-9790-40fb-8bf3-d0fbabfa2866",
            "labels": [
              "Display/Download \nfiles"
            ],
            "source": {
              "cell": "95f959ad-c996-4258-b1ed-fce33dfa5b69"
            },
            "target": {
              "cell": "0d9909ea-1398-4898-be81-cf1c808324dc"
            },
            "vertices": [
              {
                "x": 385,
                "y": 570
              },
              {
                "x": 385,
                "y": 480
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "a3ddff8f-1b74-4db6-90aa-a4c16efdab16",
            "source": {
              "x": 320,
              "y": 670
            },
            "target": {
              "x": 570,
              "y": 680
            },
            "vertices": [
              {
                "x": 340,
                "y": 570
              },
              {
                "x": 450,
                "y": 530
              },
              {
                "x": 570,
                "y": 600
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Request",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "e3e0f476-4cfd-4c27-8279-06ce6446bab8",
            "labels": [
              "Request"
            ],
            "source": {
              "cell": "22eddb4b-7085-4ae6-8837-c052c09d18cd"
            },
            "target": {
              "cell": "eb411ce7-7fe3-4cfe-b674-f4bf697c2e6e"
            },
            "vertices": [
              {
                "x": 30,
                "y": 270
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Response",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "03e87ce3-6047-439d-ba19-adaee47ff101",
            "labels": [
              "Response"
            ],
            "source": {
              "cell": "eb411ce7-7fe3-4cfe-b674-f4bf697c2e6e"
            },
            "target": {
              "cell": "22eddb4b-7085-4ae6-8837-c052c09d18cd"
            },
            "vertices": [
              {
                "x": 160,
                "y": 340
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "043cf9bd-a6b2-4727-b6c2-140a85976d55",
            "source": {
              "x": -150,
              "y": 580
            },
            "target": {
              "x": 60,
              "y": 590
            },
            "vertices": [
              {
                "x": -90,
                "y": 500
              },
              {
                "x": 40,
                "y": 500
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Logs",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "2fb770ba-6788-4436-9db1-a95c2180a9a2",
            "labels": [
              "Logs"
            ],
            "source": {
              "cell": "0d9909ea-1398-4898-be81-cf1c808324dc"
            },
            "target": {
              "cell": "047754a0-e0bf-4e52-8251-507a38b03ab2"
            },
            "vertices": [
              {
                "x": 140,
                "y": 410
              }
            ]
          },
          {
            "position": {
              "x": 360,
              "y": 580
            },
            "size": {
              "width": 160,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "File System"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 11,
            "id": "95f959ad-c996-4258-b1ed-fce33dfa5b69",
            "data": {
              "type": "tm.Store",
              "name": "File System",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "6802b1e9-46e5-4ce6-8da5-b9bf614ca0b0",
                  "title": "Upload Malicious Files",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "By letting the application have a file upload system, the files need to be stored somewhere, in a physical system. This allows malicious users to upload files that are bad to tamper the server.",
                  "mitigation": "Add security processes such as define the maximum upload file or even only accept a certain type of extension.\nUse octet stream download.\nImplement a suitable Content Security Policy (CPS) to reduce the risk from XSS vectors.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 2,
                  "score": ""
                },
                {
                  "id": "a7f8503a-ceed-4693-b279-3388b2d18809",
                  "title": "Execute command line to access other files",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "User access the filesystem by the application and by running some command can access other files.",
                  "mitigation": "Make the filesystem have files separated by folders or other strategy so that users can not access other files.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 31,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 210,
              "y": 180
            },
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Frontend\nApplication"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 12,
            "id": "22eddb4b-7085-4ae6-8837-c052c09d18cd",
            "data": {
              "type": "tm.Process",
              "name": "Frontend\nApplication",
              "description": "Process that contains all the interactions needed with the front\nend application",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "7d6dfcfc-bfc7-421a-ad8e-e570d8ddffb6",
                  "title": "Credentials Spoofing",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Get users credentials to access frontend application and pretend to be user with the stolen credentials.",
                  "mitigation": "Add strong password policies.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 21,
                  "score": ""
                },
                {
                  "id": "d32dc152-8e81-4128-b014-d75bfb8bdf7c",
                  "title": "XSS Injection",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Cross Site Injection",
                  "mitigation": "Never use unsafe functions, such as eval, and verify every input that can be inserted by the user",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 22,
                  "score": ""
                },
                {
                  "id": "e1ea603d-6967-4d57-9198-1427b39baffe",
                  "title": "Change user sensible data",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "User with stolen credentials changing sensible data such as Bank Information, Address and more.",
                  "mitigation": "Add notification for each change or even add 2 step confirmation, with e-mail or SMS Token.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 25,
                  "score": ""
                },
                {
                  "id": "7747669a-3b4a-4874-8bdd-785b4514fcfb",
                  "title": "Customer/Driver being able to perform Manager Actions",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "An user with less privilege being able to perform prohibited actions, such as a customer/driver being able to create users.",
                  "mitigation": "Add logging and roles verification.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 26,
                  "score": ""
                },
                {
                  "id": "b5aea78f-782a-440c-9c15-2e0022cfd748",
                  "title": "Hacker send too much requests",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Hacker send too much requests to the frontend page so that denies service.",
                  "mitigation": "Add configuration such as a limit of connections per machine or IP, so it blocks after a suspicious amount of requests in a short interval of time",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 27,
                  "score": ""
                },
                {
                  "id": "f2bd88c2-c0fb-4b0e-883e-320df69cad5e",
                  "title": "Accessing others information altering accessible data",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "A user, by changing something accessible, such as the request query string of the link, access other information, such as a customer accessing a service from another customer.",
                  "mitigation": "Added authorization and data protection in every page needed.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 28,
                  "score": ""
                },
                {
                  "id": "9b844a5a-0bff-4664-a2d7-34da3e86b56c",
                  "title": "Execute client functions via console to access unauthorized pages",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Elevation of privilege",
                  "description": "User executes client functions via console that redirects the browser to a page without privilege.",
                  "mitigation": "Do not render all client functions into the users browser so that the user doesn't execute them.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 30,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 620,
              "y": 180
            },
            "size": {
              "width": 160,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "Frontend Application Config"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": "4 3"
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": "4 3"
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 14,
            "id": "6ec437d3-79c1-4d2c-a620-530caeab8134",
            "data": {
              "name": "Frontend Application Config",
              "description": "",
              "type": "tm.Store",
              "isTrustBoundary": false,
              "outOfScope": true,
              "reasonOutOfScope": "",
              "threats": [
                {
                  "status": "Open",
                  "severity": "High",
                  "title": "Credentials should be encrypted",
                  "type": "Information disclosure",
                  "description": "The Web Application Config stores credentials used  by the Web App to access the message queue. These could be stolen by an attacker and used to read confidential data or place poison message on the queue.",
                  "mitigation": "The Message Queue credentials should be encrypted.",
                  "modelType": "STRIDE",
                  "id": "aaea0238-2984-4b25-8268-3798e63bed34"
                }
              ],
              "hasOpenThreats": true,
              "isALog": false,
              "storesCredentials": true,
              "isEncrypted": true,
              "isSigned": false,
              "storesInventory": null
            }
          },
          {
            "position": {
              "x": -90,
              "y": 350
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "External Geographical API"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": "4 3"
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 16,
            "id": "eb411ce7-7fe3-4cfe-b674-f4bf697c2e6e",
            "data": {
              "type": "tm.Actor",
              "name": "External Geographical API",
              "description": "",
              "outOfScope": true,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": -97.5,
              "y": 520
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Logging System"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 17,
            "id": "047754a0-e0bf-4e52-8251-507a38b03ab2",
            "data": {
              "type": "tm.Store",
              "name": "Logging System",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": true,
              "isEncrypted": true,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "402e2261-78b4-4036-ae03-0ebadb64ac5d",
                  "title": "Attacker successfully gathers credentials User with write privilege",
                  "status": "Open",
                  "severity": "High",
                  "type": "Repudiation",
                  "description": "Attacker successfully gains control of the User with write privilege, now being able to alter the logging or even deleting it.",
                  "mitigation": "Create strong password policy for this particular user.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 40,
                  "score": ""
                }
              ]
            }
          }
        ],
        "version": "2.0",
        "title": "Main Request Data Flow",
        "descrition": "Main Request Data Flow Description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "diagramType": "STRIDE",
        "id": 0
      }
    ],
    "diagramTop": 0,
    "reviewer": "DESOFS 3",
    "threatTop": 40
  },
  "version": "2.0"
}